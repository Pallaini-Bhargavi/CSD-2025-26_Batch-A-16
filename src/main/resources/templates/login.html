<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Login</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        .required::after {
            content: " *";
            color: red;
        }
    </style>
</head>
<body>

<button class="back-btn" onclick="location.href='/'">‚Üê Back</button>

<div class="page-header">
    <div class="project-title">üîê Secure Data Hiding using Calendar Heatmap steganography</div>
    <div class="page-subtitle">Login</div>
</div>

<div class="container">
    <div class="card">

        <!--  FORM SUBMITS TO BACKEND -->
        <form action="/login" method="post" onsubmit="return validateLogin()">

            <label class="required">Email</label>
            <input type="email" name="email" id="email" placeholder="Enter Email">

            <label class="required">Password</label>
            <input type="password" name="password" id="password" placeholder="Enter Password">

            <button type="submit" class="btn">Login</button>
            <div style="margin-top:14px; text-align:center;">
                <a href="/forgot-password"
                   style="color:#38bdf8; text-decoration:none; font-size:14px;">
                    Forgot / Reset Password?
                </a>
            </div>
        </form>

    </div>
</div>

<!-- ================= ERROR POPUP ================= -->
<div id="errorPopup" style="display:none; position:fixed; inset:0;
background:rgba(0,0,0,0.7); z-index:999; align-items:center; justify-content:center;">
    <div style="background:#fff; color:#dc2626; padding:22px; border-radius:16px;
                width:360px; text-align:center; font-weight:600; position:relative;">
        <span onclick="closeError()" style="position:absolute; top:10px; right:14px;
              cursor:pointer; font-size:18px; color: black;">‚úñ</span>
        <div id="errorMsg"></div>
    </div>
</div>

<!-- ================= SUCCESS POPUP ================= -->
<div id="successPopup" style="display:none; position:fixed; inset:0;
background:rgba(0,0,0,0.7); z-index:999; align-items:center; justify-content:center;">
    <div style="background:#fff; color:#16a34a; padding:22px; border-radius:16px;
                width:360px; text-align:center; font-weight:600;">
        Login successful
    </div>
</div>

<script>
function validateLogin() {
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");

    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();

    if (email === "" && password === "") {
        showError("Please fill the form.");
        return false;
    }

    if (email === "") {
        showError("Email is required.");
        return false;
    }

    if (password === "") {
        showError("Password is required.");
        return false;
    }

    return true;
}

/* ===== POPUPS ===== */
function showError(msg) {
    document.getElementById("errorMsg").innerText = msg;
    document.getElementById("errorPopup").style.display = "flex";
}
function closeError() {
    document.getElementById("errorPopup").style.display = "none";
}
function showSuccess() {
    document.getElementById("successPopup").style.display = "flex";
    setTimeout(() => location.href = "/home", 1200);
}
</script>

<!-- ===== BACKEND RESPONSES ===== -->
<script th:if="${loginError}">
    showError("[[${loginError}]]");
</script>

<script th:if="${loginSuccess}">
    showSuccess();
</script>

<script th:if="${logoutMsg}">
    showError("[[${logoutMsg}]]");
</script>

</body>
</html>
