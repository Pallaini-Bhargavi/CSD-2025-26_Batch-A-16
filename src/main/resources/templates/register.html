<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Secure Data Hiding using Calendar Heatmap steganography</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<button class="back-btn" onclick="location.href='/'">‚Üê Back</button>

<div class="page-header">
    <div class="project-title">
        üîê Secure Data Hiding using Calendar Heatmap steganography
    </div>
    <div class="page-subtitle">Register</div>
</div>

<div class="container">
    <div class="card">

    <form action="/register" method="post" onsubmit="return validateRegister()">

    <label class="required">Email</label>
    <input type="email" name="email" id="regEmail" placeholder="Enter Email">

    <label class="required">Password</label>
    <input type="password" name="password" id="regPassword" placeholder="******">

    <label class="required">Confirm Password</label>
    <input type="password" id="regConfirmPassword" placeholder="******">

    <!-- üîê SECURITY QUESTION -->
<label class="required">Security Question</label>
<select name="securityQuestion" id="securityQuestion">
    <option value="">-- Select a question --</option>

    <option>What nickname did only your family use for you?</option>
    <option>What was the name of the place where you learned something important for the first time?</option>
    <option>What was a word you often mispronounced as a child?</option>
    <option>What was the first thing you ever saved money to buy?</option>
    <option>What was the reason you were happiest on your favorite school day?</option>
    <option>What small habit do you still have from childhood?</option>
    <option>What was the first moment you felt proud of yourself?</option>
    <option>What smell reminds you most of your childhood?</option>
    <option>What sound instantly brings back old memories for you?</option>
    <option>What food taste reminds you of home?</option>
    <option>What was written on the first note you ever kept?</option>
    <option>What was the first app you remember installing on your phone?</option>
    <option>What was the first online username you ever created?</option>
    <option>What were you wearing on your first day at college?</option>
    <option>What time of day do you feel most calm?</option>
    <option>What is a movie you love but rarely talk about?</option>
    <option>What is a song you associate with a personal memory?</option>
</select>


    <label class="required">Your Answer</label>
    <input type="text" name="securityAnswer" id="securityAnswer"
       placeholder="Answer in your own words (3+ words)">

    <button type="submit" id="registerBtn" class="btn blue">Register</button>
</form>

        
    </div>
</div>

<!-- ================= ERROR POPUP ================= -->
<div id="errorPopup" style="display:none; position:fixed; inset:0;
background:rgba(0,0,0,0.7); z-index:999; align-items:center; justify-content:center;">
    <div style="
        background:#ffffff;
        color:#dc2626;
        padding:22px;
        border-radius:16px;
        width:360px;
        text-align:center;
        font-weight:600;
        position:relative;
    ">
        <!-- ‚ùå -->
        <span onclick="closeError()" style="
            position:absolute;
            top:10px;
            right:14px;
            cursor:pointer;
            font-size:18px;
            font-weight:700;
            color:#dc2626;
        ">‚úñ</span>

        <div id="errorMsg"></div>
    </div>
</div>

<!-- ================= SUCCESS POPUP ================= -->
<div id="successPopup" style="display:none; position:fixed; inset:0;
background:rgba(0,0,0,0.7); z-index:999; align-items:center; justify-content:center;">
    <div style="
        background:#ffffff;
        color:#16a34a;
        padding:22px;
        border-radius:16px;
        width:360px;
        text-align:center;
        font-weight:600;
        position:relative;
    ">
        <div id="successMsg"></div>
    </div>
</div>
<script>
function validateRegister() {

    const email = regEmail.value.trim();
    const pwd = regPassword.value;
    const cpwd = regConfirmPassword.value;
    const question = document.getElementById("securityQuestion").value;
    const answer = document.getElementById("securityAnswer").value
                  .trim()
                  .toLowerCase();

    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;

    // üîì Enable before validation
    registerBtn.disabled = false;

    if (!email) return showError("Email is required."), false;
    if (!emailPattern.test(email)) return showError("Please enter a valid email address."), false;
    if (!pwd) return showError("Password is required."), false;
    if (pwd.length < 6) return showError("Password must be at least 6 characters."), false;
    if (!cpwd) return showError("Confirm password is required."), false;
    if (pwd !== cpwd) return showError("Passwords do not match."), false;
    if (!question) return showError("Please select a security question."), false;
    if (!answer) return showError("Security answer is required."), false;
    if (answer.length < 3) return showError("Security answer is too short."), false;

    // üîí Disable button once everything is valid
    registerBtn.disabled = true;
    registerBtn.innerText = "Registering...";

    return true; 

}

const registerBtn = document.getElementById("registerBtn");

function showError(msg) {
    document.getElementById("errorMsg").innerText = msg;
    document.getElementById("errorPopup").style.display = "flex";
    registerBtn.disabled = false;   
}

function closeError() {
    document.getElementById("errorPopup").style.display = "none";
}

function showSuccess(msg) {
    document.getElementById("successMsg").innerText = msg;
    document.getElementById("successPopup").style.display = "flex";

  
    setTimeout(() => {
        window.location.href = "/login";
    }, 1000);
}

const params = new URLSearchParams(window.location.search);
if (params.get("success") === "true") {
    showSuccess(" Registration successful! Redirecting to login...");
}

</script>

</body>
</html>
